@model AccountOverview
@inject SavedSearchInject SaveSearchDetails

@{
    Func<string, string> searchEndpoint = (qs) => $"/search?{qs}";
}

<div class="row profile">
    <div class="col-md-3">
        <div class="well profile-nav">
            <h4>@Model.User.Username</h4>
            <p class="text-muted">User Profile</p>
        </div>
    </div>

    <div class="col-md-9">
            <div class="well profile-info">
                <a data-toggle="collapse" data-target="#savedSearch" class="btn-link">Saved Searches</a>
                <div id="savedSearch" class="collapse">
                    <div class="list-group">
                        @foreach (var savedSearch in Model.User.SavedSearches)
                        {
                            <a href="@searchEndpoint(new QueryStringEncoder().Encode(savedSearch.Criteria))" class="list-group-item">
                                <h4>@savedSearch.Criteria.SearchText</h4>
                                <p class="list-group-item-text">
                                    <div class="row">
                                        @{
                                            var vals = SaveSearchDetails.NonDefaultSearchValues(savedSearch.Criteria);
                                            foreach (string key in vals.Keys)
                                            {
                                                <span class="col-xs-6">
                                                    <span>@key</span><span>: </span><span>@vals[key]</span>
                                                </span>
                                            }
                                        }
                                    </div>
                                </p>
                            </a>
                        }
                    </div>
                </div>
            </div>
        </div>
</div>