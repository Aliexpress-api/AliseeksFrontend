@model AccountOverview
@inject SavedSearchInject SaveSearchDetails

@{
    Func<string, string> searchEndpoint = (qs) => $"/search?{qs}";
}

<div class="row profile">
    <div class="col-md-3">
        <div class="well profile-nav">
            <h4>@Model.User.Username</h4>
            <p class="text-muted">User Profile</p>
            <hr />
            <div class="list-group">
                <a href="/account" class="list-group-item active">Overview</a>
                <a href="/account" class="list-group-item" >Saved Searches</a>
                <a href="/account" class="list-group-item">Tracking Items</a>
                <a href="/account" class="list-group-item disabled">Dropshipping (Coming Soon)</a>
            </div>
        </div>
    </div>

    <div class="col-md-9">
            <div class="well profile-info">
                <a data-toggle="collapse" data-target="#savedSearch" class="btn-link">Saved Searches</a>
                <div id="savedSearch" class="collapse">
                    <div class="list-group">
                        @foreach (var savedSearch in Model.User.SavedSearches)
                        {
                            <div class="list-group-item">
                                <a class="btn btn-danger pull-right" href="/search/save/@savedSearch.ID" data-ajax="true" data-ajax-method="delete">&times;</a>
                                <a href="@searchEndpoint(new QueryStringEncoder().Encode(savedSearch.Criteria))">
                                    <h4>@savedSearch.Criteria.SearchText</h4>
                                    <p class="list-group-item-text">
                                        <div class="row">
                                            @{
                                                var vals = SaveSearchDetails.NonDefaultSearchValues(savedSearch.Criteria);
                                                foreach (string key in vals.Keys)
                                                {
                                                    <span class="col-xs-6">
                                                        <span>@key</span><span>: </span><span>@vals[key]</span>
                                                    </span>
                                                }
                                            }
                                        </div>
                                    </p>
                                </a>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
</div>